<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>web_ctf | LuoYuのBLOG</title><meta name="description" content="web_ctf[toc] tipsPHP备份文件：*.php.bak *.php~ xff:X-Forwarded-For（XFF）是用来识别通过HTTP代理或负载均衡方式连接到Web服务器的客户端最原始的IP地址的HTTP请求头字段。 HTTP来源地址（referer，或HTTPreferer）是HTTP表头的一个字段，用来表示从哪儿链接到当前的网页，采用的格式是URL。换句话说，借着HTTP来"><meta name="keywords" content="ctf,web,漏洞,代码审计"><meta name="author" content="LuoYu"><meta name="copyright" content="LuoYu"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="crossorigin"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="twitter:card" content="summary"><meta name="twitter:title" content="web_ctf"><meta name="twitter:description" content="web_ctf[toc] tipsPHP备份文件：*.php.bak *.php~ xff:X-Forwarded-For（XFF）是用来识别通过HTTP代理或负载均衡方式连接到Web服务器的客户端最原始的IP地址的HTTP请求头字段。 HTTP来源地址（referer，或HTTPreferer）是HTTP表头的一个字段，用来表示从哪儿链接到当前的网页，采用的格式是URL。换句话说，借着HTTP来"><meta name="twitter:image" content="http://retnull.top/img/2.jpg"><meta property="og:type" content="article"><meta property="og:title" content="web_ctf"><meta property="og:url" content="http://retnull.top/2020/04/18/web-ctf/"><meta property="og:site_name" content="LuoYuのBLOG"><meta property="og:description" content="web_ctf[toc] tipsPHP备份文件：*.php.bak *.php~ xff:X-Forwarded-For（XFF）是用来识别通过HTTP代理或负载均衡方式连接到Web服务器的客户端最原始的IP地址的HTTP请求头字段。 HTTP来源地址（referer，或HTTPreferer）是HTTP表头的一个字段，用来表示从哪儿链接到当前的网页，采用的格式是URL。换句话说，借着HTTP来"><meta property="og:image" content="http://retnull.top/img/2.jpg"><meta property="article:published_time" content="2020-04-18T08:03:44.000Z"><meta property="article:modified_time" content="2020-04-18T08:06:19.308Z"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>var autoChangeMode = '1'
var t = Cookies.get("theme")
if (autoChangeMode == '1'){
  var isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
  var isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
  var isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined){
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport){
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour < 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
  }
  } else if (t == 'light') activateLightMode()
  else activateDarkMode()

} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="http://retnull.top/2020/04/18/web-ctf/"><link rel="prev" title="python" href="http://retnull.top/2020/04/18/python/"><link rel="next" title="git总结" href="http://retnull.top/2020/04/18/my-first-blog/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://xxx/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  baiduPush: true,
  highlightCopy: true,
  highlightLang: true,
  highlightShrink: 'false',
  isFontAwesomeV5: false,
  isPhotoFigcaption: false
  
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isSidebar: true  
  }</script><noscript><style>
#page-header {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><meta name="generator" content="Hexo 4.2.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/dog.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">5</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">11</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">1</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> List</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> Movie</span></a></li></ul></div></div></div></div><i class="fa fa-arrow-right on" id="toggle-sidebar" aria-hidden="true">     </i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#web-ctf"><span class="toc-number">1.</span> <span class="toc-text">web_ctf</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#tips"><span class="toc-number">1.1.</span> <span class="toc-text">tips</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#文件包含漏洞"><span class="toc-number">1.1.1.</span> <span class="toc-text">文件包含漏洞</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#LFI-Local-File-Inclusion"><span class="toc-number">1.1.2.</span> <span class="toc-text">LFI(Local File Inclusion)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RFI-Remote-File-Inclusion"><span class="toc-number">1.1.3.</span> <span class="toc-text">RFI(Remote File Inclusion)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#php-input"><span class="toc-number">1.1.4.</span> <span class="toc-text">php:&#x2F;&#x2F;input</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#php反序列"><span class="toc-number">1.1.5.</span> <span class="toc-text">php反序列</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#CVE-2016-7124"><span class="toc-number">1.1.5.1.</span> <span class="toc-text">CVE-2016-7124</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SSTI模板注入："><span class="toc-number">1.1.6.</span> <span class="toc-text">SSTI模板注入：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#php伪协议"><span class="toc-number">1.1.7.</span> <span class="toc-text">php伪协议</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mysql-handler语句"><span class="toc-number">1.1.8.</span> <span class="toc-text">mysql handler语句</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#堆叠注入"><span class="toc-number">1.1.9.</span> <span class="toc-text">堆叠注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HTTP协议"><span class="toc-number">1.1.10.</span> <span class="toc-text">HTTP协议</span></a></li></ol></li></ol></li></ol></div></div></div><div id="body-wrap"><div class="post-bg" id="nav" style="background-image: url(/img/2.jpg)"><div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">LuoYuのBLOG</a></span><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> List</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> Movie</span></a></li></ul></div></div><span class="toggle-menu close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span></span></div><div id="post-info"><div id="post-title"><div class="posttitle">web_ctf</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2020-04-18 16:03:44"><i class="fa fa-calendar" aria-hidden="true"></i> 发表于 2020-04-18</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2020-04-18 16:06:19"><i class="fa fa-history" aria-hidden="true"></i> 更新于 2020-04-18</span></time></div><div class="meta-secondline"> </div><div class="meta-thirdline"><span class="post-meta-pv-cv"><i class="fa fa-eye post-meta__icon" aria-hidden="true"> </i><span>阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-commentcount"></span></div></div></div></div><main class="layout_post" id="content-inner"><article id="post"><div id="article-container"><h1 id="web-ctf"><a href="#web-ctf" class="headerlink" title="web_ctf"></a>web_ctf</h1><p>[toc]</p>
<h2 id="tips"><a href="#tips" class="headerlink" title="tips"></a>tips</h2><p>PHP备份文件：*.php.bak *.php~</p>
<p><strong>xff:X-Forwarded-For（XFF）是用来识别通过HTTP代理或负载均衡方式连接到Web服务器的客户端</strong>最原始的IP地址<strong>的HTTP请求头字段。</strong></p>
<p>HTTP来源地址（referer，或HTTPreferer）<br>是HTTP表头的一个字段，用来表示从哪儿链接到当前的网页，采用的格式是URL。换句话说，借着HTTP来源地址，当前的网页可以检查访客从哪里而来，这也常被用来对付伪造的跨网站请求。</p>
<p>php中的include对文件后缀无要求，只需要文件内容是PHP的语法格式</p>
<h3 id="文件包含漏洞"><a href="#文件包含漏洞" class="headerlink" title="文件包含漏洞"></a>文件包含漏洞</h3><h3 id="LFI-Local-File-Inclusion"><a href="#LFI-Local-File-Inclusion" class="headerlink" title="LFI(Local File Inclusion)"></a>LFI(Local File Inclusion)</h3><p>本地文件包含漏洞，顾名思义，指的是能打开并包含本地文件的漏洞。大部分情况下遇到的文件包含漏洞都是LFI。简单的测试用例如前所示。</p>
<h3 id="RFI-Remote-File-Inclusion"><a href="#RFI-Remote-File-Inclusion" class="headerlink" title="RFI(Remote File Inclusion)"></a>RFI(Remote File Inclusion)</h3><p>远程文件包含漏洞。是指能够包含远程服务器上的文件并执行。由于远程服务器的文件是我们可控的，因此漏洞一旦存在危害性会很大。<br>但RFI的利用条件较为苛刻，需要php.ini中进行配置</p>
<ul>
<li>allow_url_fopen = On</li>
<li>allow_url_include = On</li>
</ul>
<p>两个配置选项均需要为On，才能远程包含文件成功</p>
<h3 id="php-input"><a href="#php-input" class="headerlink" title="php://input"></a>php://input</h3><p>利用条件：</p>
<ul>
<li>allow_url_include = On。</li>
<li>对allow_url_fopen不做要求。</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">data:image/png;base64,base64编码的内容</span><br><span class="line">data:,文本数据</span><br><span class="line">data:text/plain,文本数据</span><br><span class="line">data:text/html,HTML代码</span><br><span class="line">data:text/html;base64,base64编码的HTML代码</span><br></pre></td></tr></table></figure>

<h3 id="php反序列"><a href="#php反序列" class="headerlink" title="php反序列"></a>php反序列</h3><p><strong><em>（CVE-2016-7124），即当序列化字符串中表示对象属性个数的值大于真实的属性个数时会跳过__wakeup的执行。</em></strong></p>
<h4 id="CVE-2016-7124"><a href="#CVE-2016-7124" class="headerlink" title="CVE-2016-7124"></a>CVE-2016-7124</h4><p>说到PHP反序列化漏洞 , 那就不得不提 <strong>CVE-2016-7124</strong> , 该漏洞使得攻击者可以成功的绕过 <code>__wakeup()</code> 函数 .</p>
<p>影响版本:</p>
<blockquote>
<p>PHP5 &lt; 5.6.25</p>
<p>PHP7 &lt; 7.0.10</p>
</blockquote>
<p>简单的说 , <strong>当序列化字符串中的设置的属性个数大于实际的属性个数时 , 对象属性检测就会出现异常 , 那么<code>process_nested_data()</code>就会返回0 , 反序列化产生异常 , 从而不执行 <code>__wakeup()</code> 函数 . 在此之前对象和它的属性已经被创建 , 但紧接着对象将被破坏 , 从而执行 <code>__destruct()</code> 函数 , 从而产生漏洞</strong></p>
<p> private变量 在序列化后两侧会有 \00 的特殊字符  protected类型的变量，序列化之后字符串首部会加上%00*%00。</p>
<p><strong>private</strong><br><code>数据类型:属性名长度:&quot;\00类名\00属性名&quot;;数据类型:属性值长度:&quot;属性值&quot;</code></p>
<p><strong>protected</strong><br><code>数据类型:属性名长度:&quot;\00*\00属性名&quot;;数据类型:属性值长度:属性值</code></p>
<p><strong>public</strong><br><code>数据类型:属性名长度:属性名;数据类型:属性值长度:属性值</code></p>
<p><strong>属性名上的区别在构造POC时十分关键!</strong></p>
<h3 id="SSTI模板注入："><a href="#SSTI模板注入：" class="headerlink" title="SSTI模板注入："></a>SSTI模板注入：</h3><p><a href="https://www.jianshu.com/p/aef2ae0498df" target="_blank" rel="noopener">https://www.jianshu.com/p/aef2ae0498df</a></p>
<h3 id="php伪协议"><a href="#php伪协议" class="headerlink" title="php伪协议"></a>php伪协议</h3><p><a href="https://segmentfault.com/a/1190000018991087" target="_blank" rel="noopener">https://segmentfault.com/a/1190000018991087</a></p>
<p>PHP支持的伪协议如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file:&#96;&#96;&#x2F;&#x2F; — 访问本地文件系统&#96;&#96;http:&#96;&#96;&#x2F;&#x2F; — 访问 HTTP(s) 网址&#96;&#96;ftp:&#96;&#96;&#x2F;&#x2F; — 访问 FTP(s) URLs&#96;&#96;php:&#96;&#96;&#x2F;&#x2F; — 访问各个输入&#x2F;输出流（I&#x2F;O streams）&#96;&#96;zlib:&#96;&#96;&#x2F;&#x2F; — 压缩流&#96;&#96;data:&#96;&#96;&#x2F;&#x2F; — 数据（RFC 2397）&#96;&#96;glob&#96;&#96;:&#96;&#96;&#x2F;&#x2F; — 查找匹配的文件路径模式&#96;&#96;phar:&#96;&#96;&#x2F;&#x2F; — PHP 归档&#96;&#96;ssh2:&#96;&#96;&#x2F;&#x2F; — Secure Shell 2&#96;&#96;rar:&#96;&#96;&#x2F;&#x2F; — RAR&#96;&#96;ogg:&#96;&#96;&#x2F;&#x2F; — 音频流&#96;&#96;expect:&#96;&#96;&#x2F;&#x2F; — 处理交互式的流</span><br></pre></td></tr></table></figure>

<p><strong>PHP.ini</strong></p>
<p>在php.ini里有两个重要的参数allow_url_fopen和allow_url_include</p>
<p>allow_url_fopen:默认值是ON，允许url里的封装协议访问文件</p>
<p>allow_url_include:默认值是OFF,不允许包含url里的封装协议包含文件</p>
<p><strong>php://filter</strong></p>
<p>经常使用的伪协议，一般用于任意文件读取，有时也可以用于getshell.在双OFF的情况下也可以使用.</p>
<p>php://filter是一种元封装器，用于数据流打开时筛选过滤应用。这对于一体式（all-in-one）的文件函数非常有用。类似readfile()、file()、file_get_contents(),在数据流读取之前没有机会使用其他过滤器。</p>
<p>php://filter参数</p>
<table>
<thead>
<tr>
<th>名称</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>resource=&lt;要过滤的数据流&gt;</td>
<td>这个参数是必须的。它指定了你要筛选过滤的数据流。</td>
</tr>
<tr>
<td><em>read=&lt;读链的筛选列表&gt;</em></td>
<td>该参数可选。可以设定一个或多个过滤器名称，以管道符(|)分隔</td>
</tr>
<tr>
<td><em>write=&lt;写链的筛选列表&gt;</em></td>
<td>该参数可选。可以设定一个或多个过滤器名称，以管道符(|)分隔</td>
</tr>
<tr>
<td>*&lt;；两个链的筛选列表&gt;*</td>
<td>任何没有以 <em>read=</em> 或 <em>write=</em> 作前缀 的筛选器列表会视情况应用于读或写链。</td>
</tr>
</tbody></table>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php:&#x2F;&#x2F;filter&#x2F;[read&#x2F;write]&#x3D;string.[rot13&#x2F;strip_tags&#x2F;…..]&#x2F;resource&#x3D;xxx</span><br></pre></td></tr></table></figure>

<p>filter和string过滤器连用可以对字符串进行过滤。filter的read和write参数有不同的应用场景。read用于include()和file_get_contents(),write用于file_put_contents()中。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php:&#x2F;&#x2F;filter&#x2F;convert.base64-[encode&#x2F;decode]&#x2F;resource&#x3D;xxx</span><br></pre></td></tr></table></figure>

<p>这是使用的过滤器是convert.base64-encode.它的作用就是读取upload.php的内容进行base64编码后输出。可以用于读取程序源代码经过base64编码后的数据</p>
<p><strong>php://input</strong></p>
<p>php://input可以访问请求的原始数据的只读流，将post请求的数据当作php代码执行。当传入的参数作为文件名打开时，可以将参数设为php://input,同时post想设置的文件内容，php执行时会将post内容当作文件内容。</p>
<p>需要开启allow_url_include</p>
<p>注：当enctype=”multipart/form-data”时，php://input是无效的。</p>
<p><strong>file://</strong></p>
<p>file://伪协议在双OFF的时候也可以用，用于本地文件包含</p>
<p>注：file://协议必须是绝对路径</p>
<p><strong>phar://</strong></p>
<p>PHP 归档，常常跟文件包含，文件上传结合着考察。说通俗点就是php解压缩包的一个函数，解压的压缩包与后缀无关。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">phar:&#x2F;&#x2F;test.[zip&#x2F;jpg&#x2F;png…]&#x2F;file.txt</span><br></pre></td></tr></table></figure>

<p>其实可以将任意后缀名的文件(必须要有后缀名)，只要是zip格式压缩的，都可以进行解压，因此上面可以改为phar://test.test/file.txt也可以运行。</p>
<p><strong>zip://,bzip2://, zlib://</strong></p>
<p>在双OFF的时候也可以用，</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zip:&#x2F;&#x2F;test.zip%23file.txt</span><br></pre></td></tr></table></figure>

<p>和phar://一样用于读取压缩文件，不过对于”zip://test.zip#file.txt”中的”#”要编码为”%23”.因为url的#后的内容不会被传送</p>
<p><strong>data://text/plain;base64,base编码字符串</strong></p>
<p>很常用的数据流构造器，将读取后面base编码字符串后解码的数据作为数据流的输入</p>
<h3 id="mysql-handler语句"><a href="#mysql-handler语句" class="headerlink" title="mysql handler语句"></a>mysql handler语句</h3><p><a href="https://blog.csdn.net/JesseYoung/article/details/40785137" target="_blank" rel="noopener">https://blog.csdn.net/JesseYoung/article/details/40785137</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">handler handler_table open;</span><br><span class="line">handler handler_table open as p;</span><br><span class="line">handler handler_table read first;</span><br><span class="line">handler handler_table read next;</span><br><span class="line">handler handler_table read first limit 3;</span><br><span class="line">handler handler_table read next limit 3,3;</span><br><span class="line">handler handler_table read first where c1 &gt; 2 limit 2;</span><br><span class="line">handler handler_table read next where c1 &gt;2 limit 1,2;</span><br><span class="line"> </span><br><span class="line">create index handler_index on handler_table(c1);</span><br><span class="line">handler handler_table open;</span><br><span class="line">handler handler_table read handler_index first;</span><br><span class="line">handler handler_table read handler_index next limit 3;</span><br><span class="line">handler handler_table read handler_index PREV limit 3,3;</span><br><span class="line">handler handler_table read handler_index LAST where c1 &gt; 2 limit 2;</span><br><span class="line">handler handler_table read handler_index LAST where c1 &gt; 2 limit 1,2;</span><br><span class="line">handler handler_table read handler_index &#x3D; (3);</span><br><span class="line">handler handler_table read handler_index &lt;&#x3D; (3) limit 2;</span><br><span class="line">handler handler_table read handler_index &gt;&#x3D; (3) limit 1,2;</span><br><span class="line">handler handler_table read handler_index &lt; (4)  where c1 &gt; 0 limit 2;</span><br><span class="line">handler handler_table read handler_index &gt; (1)  where c1 &lt; 6 limit 2,2;</span><br><span class="line">handler handler_table close;</span><br><span class="line">drop index handler_index on handler_table;</span><br></pre></td></tr></table></figure>

<h3 id="堆叠注入"><a href="#堆叠注入" class="headerlink" title="堆叠注入"></a>堆叠注入</h3><p><strong><em>mysql预编译</em></strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; prepare ins from &#39;insert into t select @a,@b&#39;; --编译</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mysql&gt; set @a&#x3D;999,@b&#x3D;&#39;hello&#39;;</span><br><span class="line">mysql&gt; execute ins using @a,@b;--执行</span><br><span class="line">mysql&gt; deallocate prepare ins;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec) --释放</span><br></pre></td></tr></table></figure>

<h3 id="HTTP协议"><a href="#HTTP协议" class="headerlink" title="HTTP协议"></a>HTTP协议</h3><p>==X-Forwarded-For==</p>
<blockquote>
<p>X-Forwarded-For 是一个扩展头。HTTP/1.1（RFC 2616）协议并没有对它的定义，它最开始是由 Squid 这个缓存代理软件引入，用来表示 HTTP 请求端真实 IP，现在已经成为事实上的标准，被各大 HTTP 代理、负载均衡等转发服务广泛使用，并被写入 RFC 7239（Forwarded HTTP Extension）标准之中.</p>
<p>格式：</p>
<p><code>X-Forwarded-For: IP0, IP1, IP2</code></p>
<p>==最开始的是离服务端最远的设备 IP，然后是每一级代理设备的 IP。==</p>
</blockquote>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">LuoYu</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://retnull.top/2020/04/18/web-ctf/">http://retnull.top/2020/04/18/web-ctf/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://retnull.top" target="_blank">LuoYuのBLOG</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/ctf/">ctf</a><a class="post-meta__tags" href="/tags/web/">web</a><a class="post-meta__tags" href="/tags/%E6%BC%8F%E6%B4%9E/">漏洞</a><a class="post-meta__tags" href="/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/">代码审计</a></div><div class="post_share"><div class="social-share" data-image="/img/1.jpg" data-sites="wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button button--primary button--animated"> <i class="fa fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/wechat.jpg" alt="微信"/><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/alipay.jpg" alt="支付寶"/><div class="post-qr-code__desc">支付寶</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/2020/04/18/python/"><img class="prev_cover lazyload" data-src="/img/1.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">python</div></div></a></div><div class="next-post pull_right"><a href="/2020/04/18/my-first-blog/"><img class="next_cover lazyload" data-src="/img/1.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">git总结</div></div></a></div></nav></article></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2020 By LuoYu</div><div class="framework-info"><span>驱动 </span><a href="https://retnullyu.github.io/" target="_blank" rel="noopener"><span>LuoYu</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://retnullyu.github.io/" target="_blank" rel="noopener"><span>LuoYuの主题</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">繁</a><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script defer id="ribbon" src="/js/third-party/canvas-ribbon.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="false"></script><script id="canvas_nest" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="/js/third-party/canvas-nest.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async=""></script><script src="/js/third-party/click_heart.js"></script><script>var endLoading = function () {
  document.body.style.overflow = 'auto';
  document.getElementById('loading-box').classList.add("loaded")
}
window.addEventListener('load',endLoading)</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"model":{"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body></html>